<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Screener - Natoli Tax Services</title>
    <link rel="icon" type="image/x-icon" href="_MConverter.eu_text.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        /* ── Reset & Shared Variables (matches index.html exactly) ── */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        :root {
            --forest-green: #3d5a29;
            --forest-green-dark: #2d4419;
            --dark-green-bg: #1e3a0f;
            --cream: #fafaf8;
            --cream-light: #ffffff;
            --cream-dark: #f5f3ed;
            --cream-border: #e8e6e0;
            --text-primary: #1a1a1a;
            --text-secondary: #5c5c5c;
            --text-tertiary: #8a8a8a;
            --border: #e0ded8;
            --fs-xs: 0.875rem;
            --fs-sm: 0.95rem;
            --fs-base: 1.05rem;
            --fs-md: 1.15rem;
            --fs-lg: 1.35rem;
            --fs-xl: 2.1rem;
            --fs-2xl: 2.8rem;
            --space-3xs: 0.25rem;
            --space-2xs: 0.5rem;
            --space-xs: 0.75rem;
            --space-sm: 1.25rem;
            --space-md: 2rem;
            --space-lg: 3rem;
            --space-xl: 4.5rem;
            --space-2xl: 7rem;
        }
        body {
            font-family: 'Inter', system-ui, sans-serif;
            font-size: var(--fs-base);
            color: var(--text-primary);
            background: var(--cream);
            line-height: 1.68;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        main { flex: 1 0 auto; }
        h1, h2, h3 {
            font-weight: 500;
            letter-spacing: -0.025em;
            line-height: 1.15;
        }
        .content-wrapper {
            width: 100%;
            max-width: 76rem;
            margin: 0 auto;
            padding: 0 1.5rem;
        }
        /* ── Screener Page Layout ────────────────────────── */
        .screener-hero {
            background: var(--cream-light);
            padding: clamp(3.8rem, 10vh, 5.5rem) 0 clamp(2.8rem, 7vh, 4rem);
            text-align: center;
            border-bottom: 1px solid var(--cream-border);
        }
        .screener-hero h1 {
            font-size: clamp(2rem, 5vw, 2.8rem);
            margin-bottom: var(--space-xs);
            color: var(--text-primary);
        }
        .screener-hero-sub {
            font-size: var(--fs-sm);
            color: var(--text-secondary);
            max-width: 560px;
            margin: 0 auto;
            line-height: 1.65;
        }
        .screener-body {
            padding: clamp(2.4rem, 6vh, 3.8rem) 0 clamp(3rem, 8vh, 5rem);
        }
        .screener-inner {
            max-width: 680px;
            margin: 0 auto;
        }
        /* ── Breadcrumb ───────────────────────────────────── */
        .breadcrumb {
            font-size: var(--fs-xs);
            color: var(--text-tertiary);
            margin-bottom: var(--space-md);
        }
        .breadcrumb a {
            color: var(--forest-green);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        .breadcrumb a:hover { color: var(--forest-green-dark); }
        .breadcrumb span { margin: 0 0.45rem; opacity: 0.5; }
        /* ── Info Banner ──────────────────────────────────── */
        .info-banner {
            background: var(--cream-light);
            border: 1px solid var(--cream-border);
            border-left: 3px solid var(--forest-green);
            border-radius: 10px;
            padding: 1.1rem 1.4rem;
            margin-bottom: var(--space-md);
            font-size: var(--fs-sm);
            color: var(--text-secondary);
            line-height: 1.6;
        }
        .info-banner strong {
            color: var(--text-primary);
            font-weight: 500;
        }
        /* ── Progress Bar ────────────────────────────────── */
        .progress-track {
            width: 100%;
            height: 4px;
            background: var(--cream-border);
            border-radius: 2px;
            margin-bottom: var(--space-lg);
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            background: var(--forest-green);
            border-radius: 2px;
            transition: width 0.38s ease;
        }
        .progress-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .progress-label span {
            font-size: var(--fs-xs);
            color: var(--text-tertiary);
        }
        .progress-label .progress-pct {
            color: var(--forest-green);
            font-weight: 500;
        }
        /* ── Question Card ───────────────────────────────── */
        .question-card {
            background: var(--cream-light);
            border: 1px solid var(--cream-border);
            border-radius: 14px;
            padding: clamp(1.8rem, 4vw, 2.6rem);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            transition: box-shadow 0.28s ease;
        }
        .question-card.hidden { display: none; }
        .question-card:not(.hidden) {
            animation: cardIn 0.32s ease both;
        }
        @keyframes cardIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .question-step {
            font-size: var(--fs-xs);
            color: var(--forest-green);
            font-weight: 600;
            letter-spacing: 0.04em;
            text-transform: uppercase;
            margin-bottom: 0.55rem;
        }
        .question-text {
            font-size: var(--fs-md);
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
            line-height: 1.4;
        }
        /* ── Option Items ────────────────────────────────── */
        .option-item {
            margin-bottom: 0.5rem;
        }
        .option-item label {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.85rem 1rem;
            border: 1px solid var(--cream-border);
            border-radius: 9px;
            cursor: pointer;
            background: var(--cream);
            transition: all 0.2s ease;
            font-size: var(--fs-sm);
            color: var(--text-secondary);
            line-height: 1.5;
        }
        .option-item label:hover {
            border-color: var(--forest-green);
            background: #f0f5ec;
            color: var(--text-primary);
        }
        .option-item input[type="radio"],
        .option-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            min-width: 18px;
            margin-top: 1px;
            cursor: pointer;
            accent-color: var(--forest-green);
        }
        .option-item input:checked + span {
            color: var(--text-primary);
            font-weight: 500;
        }
        .option-item:has(input:checked) label {
            border-color: var(--forest-green);
            background: #eef4ea;
        }
        /* ── Note Box ────────────────────────────────────── */
        .note-box {
            background: #fefbf0;
            border: 1px solid #ede4c4;
            border-left: 3px solid #c49a2a;
            border-radius: 9px;
            padding: 0.9rem 1.1rem;
            margin-top: var(--space-sm);
            font-size: var(--fs-xs);
            color: var(--text-secondary);
            line-height: 1.6;
        }
        .note-box strong { color: var(--text-primary); font-weight: 500; }
        /* ── Buttons ─────────────────────────────────────── */
        .btn-row {
            display: flex;
            gap: 0.75rem;
            margin-top: var(--space-md);
            flex-wrap: wrap;
        }
        .btn {
            padding: 0.78rem 2rem;
            font-size: var(--fs-sm);
            font-weight: 500;
            font-family: 'Inter', system-ui, sans-serif;
            border: none;
            border-radius: 9px;
            cursor: pointer;
            transition: all 0.22s ease;
            line-height: 1;
        }
        .btn-primary {
            background: var(--forest-green);
            color: white;
        }
        .btn-primary:hover:not(:disabled) {
            background: var(--forest-green-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(61,90,41,0.28);
        }
        .btn-primary:disabled {
            background: var(--cream-border);
            color: var(--text-tertiary);
            cursor: not-allowed;
        }
        .btn-secondary {
            background: var(--cream);
            color: var(--text-secondary);
            border: 1px solid var(--cream-border);
        }
        .btn-secondary:hover {
            border-color: var(--border);
            background: var(--cream-dark);
            color: var(--text-primary);
        }
        /* ── Result Cards ────────────────────────────────── */
        .result-card {
            background: var(--cream-light);
            border: 1px solid var(--cream-border);
            border-radius: 14px;
            padding: clamp(2.2rem, 5vw, 3rem) clamp(1.5rem, 4vw, 2.4rem);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            text-align: center;
        }
        .result-card.hidden { display: none; }
        .result-card.result-error { border-color: #dda0a0; background: #fdf6f6; }
        .result-card.result-warning { border-color: #ddc87a; background: #fefbf0; }
        .result-card.result-success { border-color: #8ab88a; background: #f4faf4; }
        .result-icon {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-sm);
            font-size: 1.4rem;
        }
        .result-error .result-icon { background: #fde8e8; color: #c0392b; }
        .result-warning .result-icon { background: #fef3d0; color: #b8860b; }
        .result-success .result-icon { background: #e0f0e0; color: var(--forest-green); }
        .result-card h2 {
            font-size: var(--fs-lg);
            margin-bottom: 0.7rem;
            color: var(--text-primary);
        }
        .result-card > p {
            font-size: var(--fs-sm);
            color: var(--text-secondary);
            max-width: 480px;
            margin: 0 auto;
            line-height: 1.7;
        }
        /* ── Eligibility Form (inside success result) ───── */
        .elig-form-section {
            margin-top: var(--space-md);
            text-align: left;
        }
        .elig-pricing {
            text-align: center;
            margin-bottom: var(--space-md);
            padding: var(--space-sm) 0;
            border-top: 1px solid var(--cream-border);
            border-bottom: 1px solid var(--cream-border);
        }
        .elig-pricing .price-tag {
            font-size: var(--fs-xl);
            font-weight: 600;
            color: var(--forest-green);
            letter-spacing: -0.03em;
        }
        .elig-pricing .price-label {
            font-size: var(--fs-sm);
            color: var(--text-secondary);
            margin-top: 0.2rem;
        }
        .elig-pricing .price-note {
            font-size: var(--fs-xs);
            color: var(--text-tertiary);
            margin-top: 0.35rem;
        }
        .elig-form-title {
            font-size: var(--fs-md);
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }
        .elig-form-sub {
            font-size: var(--fs-sm);
            color: var(--text-secondary);
            margin-bottom: var(--space-sm);
        }
        .field {
            margin-bottom: 1.2rem;
        }
        .field label {
            display: block;
            font-size: var(--fs-sm);
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.38rem;
        }
        .field label .req { color: #c0392b; }
        .field input {
            width: 100%;
            padding: 0.72rem 0.9rem;
            font-size: var(--fs-sm);
            font-family: 'Inter', system-ui, sans-serif;
            border: 1px solid var(--cream-border);
            border-radius: 8px;
            background: var(--cream);
            color: var(--text-primary);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        .field input:focus {
            outline: none;
            border-color: var(--forest-green);
            box-shadow: 0 0 0 3px rgba(61,90,41,0.12);
            background: var(--cream-light);
        }
        .field input::placeholder { color: var(--text-tertiary); }
        .btn-submit {
            width: 100%;
            padding: 0.88rem;
            font-size: var(--fs-base);
            margin-top: 0.4rem;
        }
        /* ── Footer note ─────────────────────────────────── */
        .screener-footer-note {
            max-width: 680px;
            margin: var(--space-md) auto 0;
            font-size: var(--fs-xs);
            color: var(--text-tertiary);
            line-height: 1.6;
        }
        .screener-footer-note strong { color: var(--text-secondary); font-weight: 500; }
        /* ── Responsive ──────────────────────────────────── */
        @media (max-width: 768px) {
            .content-wrapper { padding: 0 1.25rem; }
            .screener-hero {
                padding: clamp(2.8rem, 8vh, 4rem) 0 clamp(2rem, 5vh, 2.8rem);
            }
            .question-card {
                padding: 1.6rem 1.4rem;
            }
            .btn-row { flex-direction: column; }
            .btn { width: 100%; text-align: center; }
        }
        @media (max-width: 480px) {
            .question-card { padding: 1.3rem 1.1rem; }
        }
        /* ── Info Link Buttons ───────────────────────────── */
        .info-link-btn {
            background: none;
            border: none;
            color: var(--forest-green);
            cursor: pointer;
            text-decoration: underline;
            font-size: 0.9rem;
            padding: 0;
            margin-left: 0.25rem;
            font-family: inherit;
            transition: opacity 0.2s ease;
        }
        .info-link-btn:hover {
            opacity: 0.7;
        }
        /* ── Shared Info Modal Styling (Dark Green Theme) ─────────── */
        .info-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }
        .info-modal-overlay.active { display: flex; }
        .info-modal-content {
            background: var(--dark-green-bg);
            border: 1px solid rgba(248,245,238,0.12);
            border-radius: 14px;
            max-width: 540px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            padding: 2rem 2.2rem;
            position: relative;
            color: rgba(248,245,238,0.82);
            box-shadow: 0 24px 60px rgba(0,0,0,0.4);
            scrollbar-width: thin;
            scrollbar-color: rgba(248,245,238,0.18) transparent;
        }
        .info-modal-content h2 {
            color: #f8f5ee;
            font-size: 1.45rem;
            margin-bottom: 1.2rem;
        }
        .info-modal-content p {
            font-size: 0.92rem;
            line-height: 1.7;
            color: rgba(248,245,238,0.7);
            margin-bottom: 0.75rem;
        }
        .info-modal-content ul {
            margin: 1rem 0 1rem 1.5rem;
            color: rgba(248,245,238,0.7);
            font-size: 0.92rem;
            line-height: 1.75;
        }
        .info-modal-content li {
            margin-bottom: 0.5rem;
        }
        .info-modal-close {
            position: absolute;
            top: 1.2rem;
            right: 1.2rem;
            background: rgba(248,245,238,0.07);
            border: 1px solid rgba(248,245,238,0.12);
            width: 32px;
            height: 32px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            color: rgba(248,245,238,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        .info-modal-close:hover {
            background: rgba(248,245,238,0.13);
            color: #f8f5ee;
        }
        .info-modal-close i {
            line-height: 1;
            display: block;
        }
    </style>
</head>
<body>
    <div id="header-container"></div>

    <!-- Main -->
    <main>
        <!-- Screener Hero -->
        <section class="screener-hero">
            <div class="content-wrapper">
                <h1>Client Eligibility Screener</h1>
            </div>
        </section>

        <!-- Screener Body -->
        <section class="screener-body">
            <div class="content-wrapper">
                <div class="screener-inner">
                    <!-- Info Banner -->
                    <div class="info-banner">
                        <strong>Before we begin:</strong> This questionnaire helps us determine if we can assist with your tax return. Please answer all questions accurately. Completion does not guarantee acceptance of your tax return.
                    </div>

                    <!-- Progress -->
                    <div class="progress-label">
                        <span id="progressText">Question 1 of 6</span>
                        <span class="progress-pct" id="progressPct">0%</span>
                    </div>
                    <div class="progress-track">
                        <div class="progress-fill" id="progressBar"></div>
                    </div>

                    <!-- All questions and result card here (unchanged) -->
                    <!-- Q1 to Q6 and resultMessage are exactly as you had them -->

                    <!-- Q1: State -->
                    <div class="question-card" id="q1">
                        <div class="question-step">Question 1 of 6</div>
                        <div class="question-text">In which state did you live and work for the entire year of 2025?</div>
                        <div class="option-item">
                            <label>
                                <input type="radio" name="state" value="qualifying">
                                <span>Florida, Alaska, New Hampshire, South Dakota, Tennessee, Texas, Washington, or Wyoming</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="radio" name="state" value="other">
                                <span>Another state</span>
                            </label>
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-primary" id="nextBtn1" disabled>Next</button>
                        </div>
                    </div>

                    <!-- Q2: Life Events -->
                    <div class="question-card hidden" id="q2">
                        <div class="question-step">Question 2 of 6</div>
                        <div class="question-text">Did any of the following occur during the tax year?</div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="lifeEvents" value="moved">
                                <span>Moved to or worked in another state</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="lifeEvents" value="divorce">
                                <span>Got a divorce</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="lifeEvents" value="home">
                                <span>Bought or sold a home</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="lifeEvents" value="none" id="lifeEventsNone">
                                <span>None of the above</span>
                            </label>
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-secondary" id="backBtn2">Back</button>
                            <button class="btn btn-primary" id="nextBtn2" disabled>Next</button>
                        </div>
                    </div>

                    <!-- Q3: Prior Issues -->
                    <div class="question-card hidden" id="q3">
                        <div class="question-step">Question 3 of 6</div>
                        <div class="question-text">Do you have any of the following?</div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="priorIssues" value="unfiled" id="unfiledCheckbox">
                                <span>Prior-year unfiled tax returns</span>
                            </label>
                        </div>
                        <div id="unfiledYearsContainer" style="display: none; margin: 0.75rem 0 1.5rem 2.5rem; padding: 1rem; background: var(--cream); border: 1px solid var(--cream-border); border-radius: 9px;">
                            <label style="display: block; font-size: var(--fs-sm); color: var(--text-primary); margin-bottom: 0.75rem; font-weight: 500;">Which year(s)?</label>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem;">
                                <div class="option-item" style="margin: 0; padding: 0.5rem;"><label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" name="unfiledYears" value="2024"><span>2024</span></label></div>
                                <div class="option-item" style="margin: 0; padding: 0.5rem;"><label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" name="unfiledYears" value="2023"><span>2023</span></label></div>
                                <div class="option-item" style="margin: 0; padding: 0.5rem;"><label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" name="unfiledYears" value="2022"><span>2022</span></label></div>
                                <div class="option-item" style="margin: 0; padding: 0.5rem;"><label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" name="unfiledYears" value="2021"><span>2021</span></label></div>
                                <div class="option-item" style="margin: 0; padding: 0.5rem;"><label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" name="unfiledYears" value="2020"><span>2020</span></label></div>
                                <div class="option-item" style="margin: 0; padding: 0.5rem;"><label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" name="unfiledYears" value="2019"><span>2019</span></label></div>
                            </div>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="priorIssues" value="notices">
                                <span>IRS notices or letters</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="priorIssues" value="owed">
                                <span>Owed taxes last year</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="priorIssues" value="none" id="priorIssuesNone">
                                <span>None of the above</span>
                            </label>
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-secondary" id="backBtn3">Back</button>
                            <button class="btn btn-primary" id="nextBtn3" disabled>Next</button>
                        </div>
                    </div>

                    <!-- Q4: Tax Forms -->
                    <div class="question-card hidden" id="q4">
                        <div class="question-step">Question 4 of 6</div>
                        <div class="question-text">Which tax documents have you received (or expect to receive)?</div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="taxForms" value="w2">
                                <span>W-2</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="taxForms" value="1099">
                                <span>1099 (1099-NEC, 1099-INT, 1099-DIV, 1099-B, etc.)</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="taxForms" value="ssa">
                                <span>SSA-1099, 1099-R</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="taxForms" value="other">
                                <span>Other tax forms</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="taxForms" value="none" id="taxFormsNone">
                                <span>None yet</span>
                            </label>
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-secondary" id="backBtn4">Back</button>
                            <button class="btn btn-primary" id="nextBtn4" disabled>Next</button>
                        </div>
                    </div>

                    <!-- Q5: Income Sources -->
                    <div class="question-card hidden" id="q5">
                        <div class="question-step">Question 5 of 6</div>
                        <div class="question-text">How did you earn income during the tax year 2025?</div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="income" value="wages">
                                <span>Wages or Salary (W-2), Tips, IRA distributions, and/or Social Security Benefits</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="income" value="interest">
                                <span>Interest Income (bank accounts, bonds, CDs), and/or Dividend Income (stocks, mutual funds)</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="income" value="contractor">
                                <span>Independent Contractor (1099-NEC, 1099-K, etc.)</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="income" value="stocks">
                                <span>Sale of Stocks or Other Investments</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" name="income" value="other">
                                <span>Other types of income</span>
                            </label>
                        </div>
                        <div class="note-box">
                            <strong>Note:</strong> Certain income types may require additional review or may not be accepted.
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-secondary" id="backBtn5">Back</button>
                            <button class="btn btn-primary" id="nextBtn5" disabled>Submit</button>
                        </div>
                    </div>

                    <!-- Q6: E-Filing Option -->
                    <div class="question-card hidden" id="q6">
                        <div class="question-step">Question 6 of 6</div>
                        <div class="question-text">
                            Would you like to add E-Filing for $9.99?
                            <button type="button" id="efileInfoBtn" class="info-link-btn">Why should I E-file?</button>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="radio" name="efile" value="yes" id="efileYes">
                                <span>Yes, add E-Filing ($9.99)</span>
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="radio" name="efile" value="no" id="efileNo">
                                <span>No, I'll mail it myself</span>
                            </label>
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-secondary" id="backBtn6">Back</button>
                            <button class="btn btn-primary" id="submitBtn" disabled>Submit</button>
                        </div>
                    </div>

                    <!-- Result -->
                    <div id="resultMessage" class="result-card hidden"></div>

                    <!-- Footer note -->
                    <p class="screener-footer-note">
                        <strong>Important:</strong> Completion of this questionnaire does not guarantee acceptance of your tax return. Pricing and acceptance are determined after review of all tax documents.
                    </p>
                </div>
            </div>
        </section>
    </main>

    <div id="footer-container"></div>

    <!-- ALL THE MAIN SCRIPT (everything except the old broken modal part) -->
    <script>
        // ── Dynamic Header and Footer Loading ───────────────────────────────
        function loadComponent(url, containerId) {
            fetch(url)
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    doc.querySelectorAll('head link, head style').forEach(elem => {
                        const exists = Array.from(document.head.querySelectorAll(elem.tagName)).some(existing => {
                            if (elem.tagName === 'LINK') return existing.href === elem.href;
                            if (elem.tagName === 'STYLE') return existing.textContent === elem.textContent;
                            return false;
                        });
                        if (!exists) document.head.appendChild(elem.cloneNode(true));
                    });
                    document.getElementById(containerId).innerHTML = doc.body.innerHTML;
                    doc.querySelectorAll('script').forEach(script => {
                        const newScript = document.createElement('script');
                        if (script.src) newScript.src = script.src;
                        else newScript.textContent = script.textContent;
                        document.body.appendChild(newScript);
                    });
                })
                .catch(error => console.error(`Error loading ${url}:`, error));
        }

        window.addEventListener('load', () => {
            loadComponent('header.html', 'header-container');
            loadComponent('footer.html', 'footer-container');
        });

        // ── Screener Logic ──────────────────────────────────────────
        let currentQuestion = 1;
        const responses = {};

        function updateProgress() {
            const pct = ((currentQuestion - 1) / 6) * 100;
            document.getElementById('progressBar').style.width = pct + '%';
            document.getElementById('progressPct').textContent = Math.round(pct) + '%';
            document.getElementById('progressText').textContent = 'Question ' + currentQuestion + ' of 6';
        }

        function showQuestion(num) {
            document.querySelectorAll('.question-card').forEach(q => q.classList.add('hidden'));
            const card = document.getElementById('q' + num);
            card.classList.remove('hidden');
            currentQuestion = num;
            updateProgress();
            setTimeout(() => card.scrollIntoView({ behavior: 'smooth', block: 'nearest' }), 80);
        }

        // Q1
        document.querySelectorAll('input[name="state"]').forEach(radio => {
            radio.addEventListener('change', () => {
                document.getElementById('nextBtn1').disabled = false;
            });
        });
        document.getElementById('nextBtn1').addEventListener('click', function() {
            const selected = document.querySelector('input[name="state"]:checked').value;
            responses.state = selected;
            if (selected === 'other') {
                showResult('error', 'We\'re sorry, but due to your state of residence, we are unable to assist with your tax return at this time. Thank you for your understanding.');
            } else {
                showQuestion(2);
            }
        });

        // Q2
        const lifeEventsNone = document.getElementById('lifeEventsNone');
        const lifeEventsOther = document.querySelectorAll('input[name="lifeEvents"]:not(#lifeEventsNone)');
        lifeEventsNone.addEventListener('change', function() {
            if (this.checked) lifeEventsOther.forEach(cb => cb.checked = false);
        });
        lifeEventsOther.forEach(cb => {
            cb.addEventListener('change', function() {
                if (this.checked) lifeEventsNone.checked = false;
            });
        });
        document.querySelectorAll('input[name="lifeEvents"]').forEach(cb => {
            cb.addEventListener('change', () => {
                document.getElementById('nextBtn2').disabled =
                    document.querySelectorAll('input[name="lifeEvents"]:checked').length === 0;
            });
        });
        document.getElementById('backBtn2').addEventListener('click', () => showQuestion(1));
        document.getElementById('nextBtn2').addEventListener('click', function() {
            const checked = Array.from(document.querySelectorAll('input[name="lifeEvents"]:checked')).map(cb => cb.value);
            responses.lifeEvents = checked;
            if (!(checked.includes('none') && checked.length === 1)) {
                showResult('error', 'We\'re afraid that due to your responses, we are unable to assist with your tax return at this time. Thank you for your understanding.');
            } else {
                showQuestion(3);
            }
        });

        // Q3
        const priorIssuesNone = document.getElementById('priorIssuesNone');
        const priorIssuesOther = document.querySelectorAll('input[name="priorIssues"]:not(#priorIssuesNone)');
        priorIssuesNone.addEventListener('change', function() {
            if (this.checked) priorIssuesOther.forEach(cb => cb.checked = false);
        });
        priorIssuesOther.forEach(cb => {
            cb.addEventListener('change', function() {
                if (this.checked) priorIssuesNone.checked = false;
            });
        });
        document.querySelectorAll('input[name="priorIssues"]').forEach(cb => {
            cb.addEventListener('change', () => {
                document.getElementById('nextBtn3').disabled =
                    document.querySelectorAll('input[name="priorIssues"]:checked').length === 0;
            });
        });
        document.getElementById('backBtn3').addEventListener('click', () => showQuestion(2));
        document.getElementById('nextBtn3').addEventListener('click', function() {
            const checked = Array.from(document.querySelectorAll('input[name="priorIssues"]:checked')).map(cb => cb.value);
            responses.priorIssues = checked;
           
            if (checked.includes('unfiled')) {
                const unfiledYears = Array.from(document.querySelectorAll('input[name="unfiledYears"]:checked')).map(cb => cb.value);
                responses.unfiledYears = unfiledYears;
            } else {
                responses.unfiledYears = [];
            }
           
            if (checked.includes('notices')) {
                showResult('error', 'We\'re afraid that due to your responses, we are unable to assist with your tax return at this time. Thank you for your understanding.');
            } else if (checked.includes('none') ||
                     (checked.length > 0 && checked.every(v => v === 'unfiled' || v === 'owed'))) {
                showQuestion(4);
            } else {
                showResult('error', 'We\'re afraid that due to your responses, we are unable to assist with your tax return at this time. Thank you for your understanding.');
            }
        });

        // Q4
        const taxFormsNone = document.getElementById('taxFormsNone');
        const taxFormsOther = document.querySelectorAll('input[name="taxForms"]:not(#taxFormsNone)');
        taxFormsNone.addEventListener('change', function() {
            if (this.checked) taxFormsOther.forEach(cb => cb.checked = false);
        });
        taxFormsOther.forEach(cb => {
            cb.addEventListener('change', function() {
                if (this.checked) taxFormsNone.checked = false;
            });
        });
        document.querySelectorAll('input[name="taxForms"]').forEach(cb => {
            cb.addEventListener('change', () => {
                document.getElementById('nextBtn4').disabled =
                    document.querySelectorAll('input[name="taxForms"]:checked').length === 0;
            });
        });
        document.getElementById('backBtn4').addEventListener('click', () => showQuestion(3));
        document.getElementById('nextBtn4').addEventListener('click', function() {
            const checked = Array.from(document.querySelectorAll('input[name="taxForms"]:checked')).map(cb => cb.value);
            responses.taxForms = checked;
            if (checked.includes('none')) {
                showResult('warning', 'Thank you for your interest in our service. Please return once you have received your tax documents.');
            } else if (checked.includes('other')) {
                showResult('error', 'We\'re sorry, but based on the type of tax forms you have, we are unable to assist with your return at this time. Thank you for your understanding.');
            } else {
                showQuestion(5);
            }
        });

        // Q5
        document.querySelectorAll('input[name="income"]').forEach(cb => {
            cb.addEventListener('change', () => {
                document.getElementById('nextBtn5').disabled =
                    document.querySelectorAll('input[name="income"]:checked').length === 0;
            });
        });
        document.getElementById('backBtn5').addEventListener('click', () => showQuestion(4));
        document.getElementById('nextBtn5').addEventListener('click', function() {
            const checked = Array.from(document.querySelectorAll('input[name="income"]:checked')).map(cb => cb.value);
            responses.income = checked;
            if (checked.includes('other')) {
                showResult('error', 'We\'re sorry, but based on your income sources, we are unable to assist with your tax return at this time. We appreciate your understanding.');
            } else {
                showQuestion(6);
            }
        });

        // Q6
        document.querySelectorAll('input[name="efile"]').forEach(radio => {
            radio.addEventListener('change', () => {
                document.getElementById('submitBtn').disabled = false;
            });
        });
        document.getElementById('backBtn6').addEventListener('click', () => showQuestion(5));
        document.getElementById('submitBtn').addEventListener('click', function() {
            const efileSelected = document.querySelector('input[name="efile"]:checked').value;
            responses.efile = efileSelected;
           
            const checked = responses.income || [];
            const priorIssues = responses.priorIssues || [];
            let serviceType, price;
           
            if (priorIssues.includes('owed')) {
                serviceType = 'Expert';
                price = '$119.99';
            } else if (checked.includes('stocks')) {
                serviceType = 'Expert';
                price = '$119.99';
            } else if (priorIssues.includes('unfiled')) {
                serviceType = 'Standard';
                price = '$89.99';
            } else if (checked.length === 1 && checked[0] === 'wages') {
                serviceType = 'Value';
                price = '$49.99';
            } else {
                serviceType = 'Standard';
                price = '$89.99';
            }
           
            responses.serviceType = serviceType.toLowerCase();
            showEligibilityForm(serviceType, price);
        });

        // Result functions
        function showResult(type, message) {
            document.querySelectorAll('.question-card').forEach(q => q.classList.add('hidden'));
            const icons = { error: '<i class="fas fa-times"></i>', warning: '<i class="fas fa-clock"></i>', success: '<i class="fas fa-check"></i>' };
            const titles = { error: 'We\'re Unable to Assist', warning: 'Please Come Back Later', success: 'You Qualify!' };
            const resultDiv = document.getElementById('resultMessage');
            resultDiv.className = 'result-card result-' + type;
            resultDiv.innerHTML =
                '<div class="result-icon">' + icons[type] + '</div>' +
                '<h2>' + titles[type] + '</h2>' +
                '<p>' + message + '</p>';
            resultDiv.classList.remove('hidden');
            document.getElementById('progressBar').style.width = '100%';
            document.getElementById('progressPct').textContent = '100%';
            document.getElementById('progressText').textContent = 'Complete';
            setTimeout(() => resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' }), 80);
        }

        function showEligibilityForm(serviceType, price) {
            document.querySelectorAll('.question-card').forEach(q => q.classList.add('hidden'));
            const urlParams = new URLSearchParams(window.location.search);
            const referralAgent = urlParams.get('ref') || '';
            const resultDiv = document.getElementById('resultMessage');
            resultDiv.className = 'result-card result-success';
            resultDiv.innerHTML =
                '<div class="result-icon"><i class="fas fa-check"></i></div>' +
                '<h2>Congratulations!</h2>' +
                '<p>You are eligible for our <strong>' + serviceType + ' Tax Return Service</strong>.</p>' +
                '<div class="elig-pricing">' +
                    '<div class="price-tag">' + price + '</div>' +
                    '<div class="price-label">' + serviceType + ' Tax Return Service</div>' +
                    '<div class="price-note">Not including applicable e-filing fees or mailing fees</div>' +
                '</div>' +
                '<div class="elig-form-section">' +
                    '<div class="elig-form-title">What\'s Next?</div>' +
                    '<div class="elig-form-sub">Let\'s create your Client Profile to get started.</div>' +
                    '<div class="field">' +
                        '<label>Email Address <span class="req">*</span></label>' +
                        '<input type="email" id="email" required placeholder="you@example.com">' +
                    '</div>' +
                    '<div class="field">' +
                        '<label>Full Name <span class="req">*</span></label>' +
                        '<input type="text" id="fullName" required placeholder="Jane Doe">' +
                    '</div>' +
                    '<div class="field">' +
                        '<label>Phone Number <span style="color:var(--text-tertiary);font-weight:400;">(Optional)</span></label>' +
                        '<input type="tel" id="phone" placeholder="(555) 123-4567">' +
                    '</div>' +
                    '<div class="field">' +
                        '<label>Referral Agent <span style="color:var(--text-tertiary);font-weight:400;">(If applicable)</span></label>' +
                        '<input type="text" id="referralAgent" value="' + referralAgent + '" placeholder="Agent name or code">' +
                    '</div>' +
                    '<button class="btn btn-primary btn-submit" id="submitProfileBtn">Submit</button>' +
                '</div>';
            resultDiv.classList.remove('hidden');
            document.getElementById('progressBar').style.width = '100%';
            document.getElementById('progressPct').textContent = '100%';
            document.getElementById('progressText').textContent = 'Complete';
            setTimeout(() => resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' }), 80);

            document.getElementById('submitProfileBtn').addEventListener('click', function() {
                const emailEl = document.getElementById('email');
                const nameEl = document.getElementById('fullName');
                if (!emailEl.value.trim()) { emailEl.focus(); return; }
                if (!nameEl.value.trim()) { nameEl.focus(); return; }
                const formData = {
                    serviceType: serviceType,
                    price: price,
                    email: emailEl.value,
                    fullName: nameEl.value,
                    phone: document.getElementById('phone').value,
                    referralAgent: document.getElementById('referralAgent').value,
                    screenerResponses: responses
                };
                sessionStorage.setItem('clientData', JSON.stringify(formData));
                window.location.href = 'next-steps.html';
            });
        }

        // ── Init ────────────────────────────────────────────
        updateProgress();

        // Make entire option boxes clickable
        document.querySelectorAll('.option-item').forEach(item => {
            item.addEventListener('click', function(e) {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'LABEL') return;
                const input = this.querySelector('input[type="radio"], input[type="checkbox"]');
                if (input && !input.disabled) input.click();
            });
        });

        // Unfiled years toggle
        const unfiledCheckbox = document.getElementById('unfiledCheckbox');
        const unfiledYearsContainer = document.getElementById('unfiledYearsContainer');
        if (unfiledCheckbox && unfiledYearsContainer) {
            unfiledCheckbox.addEventListener('change', function() {
                if (this.checked) {
                    unfiledYearsContainer.style.display = 'block';
                } else {
                    unfiledYearsContainer.style.display = 'none';
                    document.querySelectorAll('input[name="unfiledYears"]').forEach(cb => cb.checked = false);
                }
            });
        }
    </script>

    <!-- E-file Info Modal -->
    <div class="info-modal-overlay" id="efileModal">
        <div class="info-modal-content">
            <button class="info-modal-close" id="efileClose"><i class="fas fa-times"></i></button>
            <h2>Why should you E-file?</h2>
            <ul>
                <li>Eliminates the hassle and cost of mailing your return yourself</li>
                <li>Allows the IRS to receive your return faster</li>
                <li>Helps you to get your refund even sooner</li>
                <li>Provides confirmation when your return is accepted</li>
                <li>Adds peace of mind</li>
            </ul>
        </div>
    </div>

    <!-- FINAL MODAL SCRIPT - placed AFTER the modal HTML so it always finds the element -->
    <script>
        // ── E-file Modal (SAFE VERSION) ──────────────────────────────────────────
        const efileModal = document.getElementById('efileModal');
        const efileInfoBtn = document.getElementById('efileInfoBtn');
        const efileClose = document.getElementById('efileClose');

        if (efileInfoBtn) {
            efileInfoBtn.addEventListener('click', () => {
                if (efileModal) efileModal.classList.add('active');
            });
        }

        if (efileClose) {
            efileClose.addEventListener('click', () => {
                if (efileModal) efileModal.classList.remove('active');
            });
        }

        if (efileModal) {
            efileModal.addEventListener('click', (e) => {
                if (e.target === efileModal) {
                    efileModal.classList.remove('active');
                }
            });
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && efileModal && efileModal.classList.contains('active')) {
                efileModal.classList.remove('active');
            }
        });
    </script>
</body>
</html>
